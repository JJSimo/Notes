Per compilare un nuovo file con pin devi modificare il `makefile.rules`
Per esempio 
al posto di qst (x il framework del 3Â° assign, dove il framework si chiama `inscount0.cpp`):
`TEST_TOOL_ROOTS := inscount0`

Se vogliamo compilare un file che si chiama `test.cpp`:
=> modifichiamo la riga con -->  `TEST_TOOL_ROOTS := test`


Return address obfuscation:
La fz modifica l'indirizzo di ritorno, tipo indirizzo vero + 2 istruzioni

Call address obfuscation:
La fz chiama una fz intermediaria, la fz intermediaria chiama la vera fz

no hardcoded addresses:
trova il base address
dall'indirizzo che hai sottrai il base address e in questo modo -->  trovi il "vero indirizzo"
Nello script in ghidra:
- trova il base address
- aggiungi al base address il vero indirizzo

----
Instrumenta ogni call e printa l'indirizzo contenuto  in `eax` per esempio
![[Pasted image 20240508115135.png]]

istruzione alla quale viene chiamata la funzione
istruzione di dove si trova la funzione in se
https://stackoverflow.com/questions/49862142/intel-pin-how-to-obtain-return-address-of-system-call

NOP = Call address - previous instruction address + 1 - 4


--- 
Nel metodo per instrumentare
