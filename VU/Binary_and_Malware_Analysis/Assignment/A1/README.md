# System calls
The first thing that I found is that there is only one function that makes the system calls.
Every time that a system call is needed, its integer value is passed inside the EAX register and then this single function is called to perform the system call. So to "decrypt" all the system calls I searched what every system call number is associated to which call.

# Anti Debugging
As you showed in the slides, one method to test if a binary is running inside a debugger is by using the ptrace system call.
ptrace returns 0 on success and -1 on error.
In the binary I found 2 calls to ptrace.
Since only one debugger can be attached to a program at any time:
- the first ptrace call should return 0 (so that the binary can debug itself and bypass the check
- and consequently the second call should return -1 (because the binary is already being traced, so the correct value that ptrace should return is an error).

To patch these 2 calls I inserted, instead of the ptrace calls, the right returning values inside the register used to store the ptrace result. E dove necessario ho aggiunto delle istruzioni NOP per mantenere lo stesso numero di bytes usati dalle originarie chiamate a ptrace.

# Anti VM and HW detection 
One of the functions within main is something like an encryption function.  It takes 3 parameters and It utilizes a loop to encrypt bytes in the second one using XOR operation with the constant 0x4a and storing the results inside the first parameter.
By writing a simple program I could decrypt all the strings that I found inside the binary.

One other function in main is a string compare function. I found it twice:
the first strings comparison is with the VU AMSTERDAM string. 
Since the string_compare function returns 0 if the 2 compared strings are equal, I patched the first call to this function with `XOR EAX, EAX` and  three `NOP`s (because I believe that the VU AMSTERDAM comparison is related to the Platform Detection).
The second string comparison is with innotek_GmbH and I think that this comparison is one of the Anti VM checks, so I patched the second string_compare call with  `MOV EAX, 1`.
