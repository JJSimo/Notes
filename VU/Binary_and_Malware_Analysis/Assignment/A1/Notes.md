- C'è solo una funzione che fa le system call![[Pasted image 20240406160633.png]]
- ogni volta che serve usare una system call:
  viene passato dentro `EAX` il code della system call usata
	Es per la prima funzione in main:![[Pasted image 20240406160354.png]]

	Se guardiamo nella  [Linux System Call Table](https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md#linux-system-call-table):
	12 corrisponde alla system call `brk`![[Pasted image 20240406160537.png]]


https://reverseengineering.stackexchange.com/questions/31749/how-to-bypass-anti-debugger-ida-pro


## ANTI-VM
c'è una funzione che chiama la system call `ptrace`
`ptrace` -->   può essere usata per testare se stai usando un debugger

Il valore di ritorno di una funzione in assembly x86-64 è settato dentro -->  `RAX`
=>
- Controlliamo dove la funzione sys_ptrace() viene chiamata
  tasto dx sulla fx `sys_ptrace()` > References >