
# Adapt angr_bf’s I/O to the universe dialect
To adapt angr_bf’s I/O to the universe dialect, so that the `.` and `,` operations are self-incrementing, I modified the `simos_bf.py` file because these operations involve interaction with the operating system simulated by `simos_bf.py`.
These operations are implemented by simulated system calls, that are indeed handled by `simos_bf.py`.
So, I simply incremented the pointer after performing the corresponding I/O operations in both the 2 classes `ReadByteToPtr` and `WriteByteAtPtr` in this way:
`self.state.regs.ptr += 1`.

# Determine required input & recover 1st part of message
Then, I created an angr script to analyze the `universe.vbf` program.
I started by creating a blank state at address 0 within the project. Next, I defined a symbolic buffer of size 29 bytes, used to model incoming input through the standard input of the program. 
I then set the state input stream (that is what the program receives as input during execution) so that it is represented as a symbolic data stream, rather than as concrete data.
To do that I used:
`stdin=angr.SimFileStream(name="stdin", content=buffer)`
 I used `SimFileStream`, which simulates the file stream representing the input the program receives during execution and specifying that the content of the input stream will be initialized with the data contained in the bit vector `buffer`.
 After that, I use the `explore` method and and I set the find address to the last address before the first conditional flag operation.
 Then,, if the program finds a solution, I print the input message and the output of the program using the `eval` method to print the concrete value of my buffer and `posix.dumps(1).decode()` to extract the standard output and encode it into a string.



